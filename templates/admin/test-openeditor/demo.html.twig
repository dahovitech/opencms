{% extends 'admin/base.html.twig' %}

{% block title %}Démonstration OpenEditor{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('assets/styles/openeditor/open-editor.css') }}" rel="stylesheet">
    <style>
        .demo-hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .demo-section {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .demo-card {
            transition: transform 0.3s;
        }
        
        .demo-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .code-preview {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 1rem;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container-fluid">
    <!-- Hero Section -->
    <div class="demo-hero">
        <h1 class="display-4 mb-3">
            <i class="bi bi-magic"></i> OpenEditor Demo
        </h1>
        <p class="lead mb-4">
            Découvrez toutes les fonctionnalités d'OpenEditor intégrées à OpenCMS
        </p>
        <div class="btn-group">
            <a href="{{ path('admin_test_openeditor_new') }}" class="btn btn-light btn-lg">
                <i class="bi bi-play"></i> Tester maintenant
            </a>
            <a href="{{ path('admin_test_openeditor_index') }}" class="btn btn-outline-light btn-lg">
                <i class="bi bi-list"></i> Voir les tests
            </a>
        </div>
    </div>

    <!-- Fonctionnalités Principales -->
    <div class="row mb-5">
        <div class="col-md-4 mb-4">
            <div class="card demo-card h-100">
                <div class="card-body text-center">
                    <div class="feature-icon text-primary">
                        <i class="bi bi-pencil-square"></i>
                    </div>
                    <h5 class="card-title">Éditeur WYSIWYG</h5>
                    <p class="card-text">
                        Interface intuitive pour créer du contenu riche avec formatage avancé,
                        listes, liens et bien plus.
                    </p>
                    <div class="code-preview text-start">
                        <small>
                            {{ "'description', OpenEditorType::class, [<br>
                            &nbsp;&nbsp;'toolbar_config' => 'full',<br>
                            &nbsp;&nbsp;'theme' => 'modern'<br>
                            ]"|raw }}
                        </small>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card demo-card h-100">
                <div class="card-body text-center">
                    <div class="feature-icon text-success">
                        <i class="bi bi-images"></i>
                    </div>
                    <h5 class="card-title">Gestionnaire de Médias</h5>
                    <p class="card-text">
                        Intégration native avec le système de médias d'OpenCMS pour insérer
                        images et fichiers directement.
                    </p>
                    <div class="code-preview text-start">
                        <small>
                            {{ "'media_enabled' => true,<br>
                            'media_manager_url' => '/admin/media',<br>
                            'upload_url' => '/admin/media/upload'"|raw }}
                        </small>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card demo-card h-100">
                <div class="card-body text-center">
                    <div class="feature-icon text-warning">
                        <i class="bi bi-cloud-check"></i>
                    </div>
                    <h5 class="card-title">Sauvegarde Auto</h5>
                    <p class="card-text">
                        Sauvegarde automatique du contenu à intervalles réguliers pour éviter
                        la perte de données.
                    </p>
                    <div class="code-preview text-start">
                        <small>
                            {{ "'autosave' => true,<br>
                            'autosave_interval' => 45000,<br>
                            // 45 secondes"|raw }}
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Démonstration Interactive -->
    <div class="demo-section mb-5">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">
                <i class="bi bi-play-circle"></i> Démonstration Interactive
            </h4>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-lg-6">
                    <h5>Configuration de Test</h5>
                    <div class="mb-3">
                        <label class="form-label">Thème</label>
                        <select class="form-select" id="demo-theme">
                            <option value="default">Défaut</option>
                            <option value="dark">Sombre</option>
                            <option value="modern" selected>Moderne</option>
                            <option value="minimal">Minimal</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Toolbar</label>
                        <select class="form-select" id="demo-toolbar">
                            <option value="minimal">Minimal</option>
                            <option value="default">Défaut</option>
                            <option value="full" selected>Complet</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Hauteur</label>
                        <select class="form-select" id="demo-height">
                            <option value="300px">300px</option>
                            <option value="400px" selected>400px</option>
                            <option value="500px">500px</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="apply-config">
                        <i class="bi bi-arrow-clockwise"></i> Appliquer la Configuration
                    </button>
                </div>
                <div class="col-lg-6">
                    <h5>Aperçu OpenEditor</h5>
                    <div class="border rounded p-3">
                        <label class="form-label">Description du Service</label>
                        <textarea class="form-control open-editor-field" id="demo-editor" rows="8"
                                  data-toolbar-config="full"
                                  data-theme="modern"
                                  data-height="400px"
                                  data-media-enabled="true"
                                  data-autosave="false"
                                  data-placeholder="Testez OpenEditor ici...">
<p><strong>Bienvenue dans OpenEditor !</strong></p>
<p>Cet éditeur offre une expérience d'édition moderne et intuitive avec :</p>
<ul>
    <li>Formatage de texte <em>riche</em></li>
    <li>Insertion d'images et médias</li>
    <li>Listes et tableaux</li>
    <li>Liens et citations</li>
</ul>
<blockquote>
    <p>"OpenEditor révolutionne la création de contenu dans OpenCMS"</p>
</blockquote>
                        </textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Exemples de Configuration -->
    <div class="demo-section mb-5">
        <div class="card-header bg-info text-white">
            <h4 class="mb-0">
                <i class="bi bi-code-slash"></i> Exemples de Configuration
            </h4>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-lg-4">
                    <h6>Configuration Minimale</h6>
                    <div class="code-preview mb-3">
                        <pre><code>$builder->add('content', 
    OpenEditorType::class, [
        'toolbar_config' => 'minimal',
        'theme' => 'default',
        'height' => '200px'
    ]
);</code></pre>
                    </div>
                </div>
                <div class="col-lg-4">
                    <h6>Configuration Complète</h6>
                    <div class="code-preview mb-3">
                        <pre><code>$builder->add('description', 
    OpenEditorType::class, [
        'toolbar_config' => 'full',
        'theme' => 'modern',
        'height' => '500px',
        'media_enabled' => true,
        'autosave' => true,
        'autosave_interval' => 30000
    ]
);</code></pre>
                    </div>
                </div>
                <div class="col-lg-4">
                    <h6>Configuration Personnalisée</h6>
                    <div class="code-preview mb-3">
                        <pre><code>$builder->add('content', 
    OpenEditorType::class, [
        'toolbar_config' => 'custom',
        'toolbar_groups' => [
            ['bold', 'italic'],
            ['link', 'image'],
            ['ul', 'ol']
        ],
        'theme' => 'dark'
    ]
);</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistiques et Performance -->
    <div class="row">
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-4 text-primary">
                        <i class="bi bi-lightning"></i>
                    </div>
                    <h5 class="card-title">Ultra Rapide</h5>
                    <p class="card-text">Initialisation en moins de 500ms</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-4 text-success">
                        <i class="bi bi-shield-check"></i>
                    </div>
                    <h5 class="card-title">Sécurisé</h5>
                    <p class="card-text">Validation complète des données</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-4 text-info">
                        <i class="bi bi-globe"></i>
                    </div>
                    <h5 class="card-title">Multi-langues</h5>
                    <p class="card-text">Support complet des traductions</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="display-4 text-warning">
                        <i class="bi bi-gear"></i>
                    </div>
                    <h5 class="card-title">Configurable</h5>
                    <p class="card-text">Options étendues et flexibles</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('assets/js/openeditor/open-editor.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎮 Initialisation de la démonstration OpenEditor...');
            
            // Initialiser l'éditeur de démonstration
            if (typeof $ !== 'undefined') {
                const $demoEditor = $('#demo-editor');
                
                // Initialiser OpenEditor
                $demoEditor.openEditor({
                    theme: 'modern',
                    height: '400px',
                    toolbar: {
                        config: 'full'
                    },
                    mediaEnabled: true,
                    autosave: false
                });

                // Configuration dynamique
                $('#apply-config').on('click', function() {
                    const theme = $('#demo-theme').val();
                    const toolbar = $('#demo-toolbar').val();
                    const height = $('#demo-height').val();
                    
                    console.log('Applique configuration:', { theme, toolbar, height });
                    
                    // Détruire l'instance existante
                    if (window.OpenEditor && window.OpenEditor.getInstance('#demo-editor')) {
                        window.OpenEditor.destroy('#demo-editor');
                    }
                    
                    // Recréer avec la nouvelle configuration
                    setTimeout(() => {
                        $demoEditor.openEditor({
                            theme: theme,
                            height: height,
                            toolbar: {
                                config: toolbar
                            },
                            mediaEnabled: true,
                            autosave: false
                        });
                    }, 100);
                    
                    // Feedback visuel
                    const btn = $(this);
                    const originalText = btn.html();
                    btn.html('<i class="bi bi-check"></i> Configuration appliquée !');
                    setTimeout(() => {
                        btn.html(originalText);
                    }, 2000);
                });

                console.log('✅ Démonstration OpenEditor initialisée');
            } else {
                console.error('❌ jQuery non disponible pour la démonstration');
            }
        });
    </script>
{% endblock %}